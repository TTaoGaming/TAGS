<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Sync System - Test Suite</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: #1a1a1a;
            color: #ffffff;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }
        
        .test-section {
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #444;
        }
        
        .test-controls {
            text-align: center;
            margin: 30px 0;
        }
        
        button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #0056CC;
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .console-output {
            background: #000;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin: 20px 0;
            border: 1px solid #333;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .result-card {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #007AFF;
        }
        
        .result-card.passed {
            border-left-color: #34C759;
        }
        
        .result-card.failed {
            border-left-color: #FF3B30;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-passed {
            background: #34C759;
            color: white;
        }
        
        .status-failed {
            background: #FF3B30;
            color: white;
        }
        
        .code-block {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            border: 1px solid #333;
            margin: 10px 0;
        }
        
        .phase-indicator {
            display: inline-block;
            padding: 8px 16px;
            background: #667eea;
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 0 10px;
        }
        
        .success-rate {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        
        .success-high { color: #34C759; }
        .success-medium { color: #FF9500; }
        .success-low { color: #FF3B30; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Documentation Sync System</h1>
            <p><span class="phase-indicator">Phase 2: Test-Driven Implementation</span></p>
            <p>Automated Documentation Validation & Sync Testing Suite</p>
        </div>
        
        <div class="test-section">
            <h2>üìã Test Overview</h2>
            <p>This test suite validates the core functionality of the DocumentationSyncSystem before integration into the main monolith:</p>
            <ul>
                <li>‚úÖ <strong>Version Consistency Validation</strong> - Detect and report version mismatches</li>
                <li>‚úÖ <strong>Line Number Accuracy Checking</strong> - Validate navigation map references</li>
                <li>‚úÖ <strong>Cross-Reference Validation</strong> - Verify internal documentation links</li>
                <li>‚úÖ <strong>Console Interface Functionality</strong> - Test command interface operations</li>
                <li>‚úÖ <strong>Settings Integration</strong> - Validate persistence and retrieval</li>
                <li>‚úÖ <strong>Sync Operations</strong> - Test automated fix procedures</li>
            </ul>
        </div>
        
        <div class="test-controls">
            <button onclick="runTests()" id="runTestsBtn">üß™ Run All Tests</button>
            <button onclick="clearConsole()" id="clearBtn">üóëÔ∏è Clear Console</button>
            <button onclick="exportResults()" id="exportBtn" disabled>üìä Export Results</button>
        </div>
        
        <div class="test-section">
            <h2>üíª Console Output</h2>
            <div id="console" class="console-output">
Ready to run tests. Click "Run All Tests" to begin validation...
            </div>
        </div>
        
        <div id="resultsSection" style="display: none;">
            <div class="test-section">
                <h2>üìä Test Results</h2>
                <div id="successRate" class="success-rate"></div>
                <div id="resultsGrid" class="results-grid"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîß Manual Testing Commands</h2>
            <p>After running tests, you can use these console commands for manual testing:</p>
            <div class="code-block">
// Test system status
docSyncTest.reportTestResults()

// Access test results data
window.docSyncTestResults

// Re-run specific test types
const test = new DocumentationSyncSystemTest()
            </div>
        </div>
        
        <div class="test-section">
            <h2>üìã Phase 2 Success Criteria</h2>
            <ul>
                <li><strong>90%+ test success rate</strong> - Ready for Phase 3 integration</li>
                <li><strong>70-89% success rate</strong> - Address failing tests before integration</li>
                <li><strong>&lt;70% success rate</strong> - Review implementation and fix critical issues</li>
            </ul>
            <p><strong>Next Steps:</strong> Upon successful completion (‚â•90%), proceed to Phase 3 (Staging & Validation) by integrating into the main monolith.</p>
        </div>
    </div>

    <script>
        // Console output capture
        let consoleOutput = '';
        const consoleElement = document.getElementById('console');
        
        // Override console methods to capture output
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function captureToConsole(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const formattedMessage = `[${timestamp}] ${message}\n`;
            consoleOutput += formattedMessage;
            consoleElement.textContent = consoleOutput;
            consoleElement.scrollTop = consoleElement.scrollHeight;
            
            // Also log to real console
            if (type === 'error') {
                originalError(message);
            } else if (type === 'warn') {
                originalWarn(message);
            } else {
                originalLog(message);
            }
        }
        
        console.log = (...args) => captureToConsole(args.join(' '), 'log');
        console.error = (...args) => captureToConsole('‚ùå ' + args.join(' '), 'error');
        console.warn = (...args) => captureToConsole('‚ö†Ô∏è ' + args.join(' '), 'warn');
        
        let testResults = null;
        
        async function runTests() {
            const runBtn = document.getElementById('runTestsBtn');
            const exportBtn = document.getElementById('exportBtn');
            
            runBtn.disabled = true;
            runBtn.textContent = 'üîÑ Running Tests...';
            
            // Clear previous results
            consoleOutput = '';
            consoleElement.textContent = 'Starting DocumentationSyncSystem tests...\n';
            document.getElementById('resultsSection').style.display = 'none';
            
            try {
                // Load and run the test script
                const response = await fetch('documentation-sync-test.js');
                const testScript = await response.text();
                
                // Execute the test script
                eval(testScript);
                
                // Wait for tests to complete
                setTimeout(() => {
                    if (window.docSyncTestResults) {
                        testResults = window.docSyncTestResults;
                        displayResults(testResults);
                        exportBtn.disabled = false;
                    }
                }, 2000);
                
            } catch (error) {
                console.error('Failed to run tests:', error);
            } finally {
                runBtn.disabled = false;
                runBtn.textContent = 'üß™ Run All Tests';
            }
        }
        
        function displayResults(results) {
            const resultsSection = document.getElementById('resultsSection');
            const successRateElement = document.getElementById('successRate');
            const resultsGrid = document.getElementById('resultsGrid');
            
            // Show results section
            resultsSection.style.display = 'block';
            
            // Display success rate
            const successClass = results.successRate >= 90 ? 'success-high' : 
                                results.successRate >= 70 ? 'success-medium' : 'success-low';
            
            successRateElement.innerHTML = `
                <div class="${successClass}">
                    ${results.successRate}% Success Rate
                </div>
                <div style="font-size: 16px; margin-top: 10px;">
                    ${results.passed}/${results.total} tests passed
                </div>
            `;
            
            // Display individual test results
            resultsGrid.innerHTML = '';
            results.results.forEach((result, index) => {
                const card = document.createElement('div');
                card.className = `result-card ${result.passed ? 'passed' : 'failed'}`;
                
                const statusBadge = `<span class="status-badge ${result.passed ? 'status-passed' : 'status-failed'}">
                    ${result.passed ? 'PASSED' : 'FAILED'}
                </span>`;
                
                card.innerHTML = `
                    <h3>Test ${index + 1}: ${result.test} ${statusBadge}</h3>
                    <p><strong>Details:</strong> ${result.details}</p>
                    ${result.error ? `<p><strong>Error:</strong> ${result.error}</p>` : ''}
                    ${result.data ? `<details>
                        <summary>Test Data</summary>
                        <div class="code-block">${JSON.stringify(result.data, null, 2)}</div>
                    </details>` : ''}
                `;
                
                resultsGrid.appendChild(card);
            });
            
            // Show readiness message
            if (results.ready) {
                console.log('üéâ SUCCESS: Ready for Phase 3 (Staging & Validation)');
                console.log('üí° Next: Integrate into main monolith and test with real system');
            } else if (results.successRate >= 70) {
                console.log('‚ö†Ô∏è PARTIAL SUCCESS: Some issues need addressing');
                console.log('üîß Recommendation: Fix failing tests before integration');
            } else {
                console.log('‚ùå FAILED: Significant issues need resolution');
                console.log('üö® Recommendation: Review implementation and fix critical issues');
            }
        }
        
        function clearConsole() {
            consoleOutput = '';
            consoleElement.textContent = 'Console cleared. Ready for new test run...\n';
        }
        
        function exportResults() {
            if (!testResults) {
                alert('No test results to export. Please run tests first.');
                return;
            }
            
            const exportData = {
                timestamp: new Date().toISOString(),
                phase: 'Phase 2: Test-Driven Implementation',
                results: testResults,
                consoleOutput: consoleOutput
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `documentation-sync-test-results-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            console.log('üìä Test results exported successfully');
        }
        
        // Initialize
        console.log('ü§ñ Documentation Sync System Test Suite Ready');
        console.log('üìã Phase 2: Test-Driven Implementation');
        console.log('üí° Click "Run All Tests" to begin validation');
    </script>
</body>
</html> 